# 实现交互

## 1 上一个demo无法实现交互

元素事件是基于浏览器执行的，只有在浏览器端执行了相应的js代码才能绑定事件。而上个demo实现的是在Node端输出一个静态页。所以我们需要让代码在浏览器端也执行一次，组件在浏览器端挂载完后react会自动完成事件绑定。即将前端代码打包成一个JS文件，并塞进Node端输出的HTML页面。浏览器在处理解析Node返回的HTML时，遇到script会去下载并执行该JS，完成事件绑定。

## 2 操作步骤

1. 给组件添加点击事件。
2. 添加浏览器端渲染入口文件。
3. 将代码打包编译到dist/static中（webpack）。
4. 将dist/static作为静态资源目录，提供访问（koa-static）。
5. 在Node端将组件转成HTML并引入打包好的JS。
6. 编译Node端代码（babel）。
7. 运行服务

## 3 浏览器也执行一次代码，组件不会重复渲染吗？

浏览器接管页面后，react-dom在渲染组件前会先和页面中的节点做对比，只有对比失败的时候才会采用客户端的内容进行渲染，且react会尽量多的复用已有的节点。

以上功能由react-dom的hydrate方法提供。hydrate是 React 中提供在初次渲染的时候，去复用原本已经存在的 DOM 节点，减少重新生成节点以及删除原本 DOM 节点的开销，来加速初次渲染的功能。


启动过程：
```
yarn
yarn run dev 
yarn run babel-node
yarn run start
```
